{"version":3,"sources":["components/shop/ShopProducts.jsx"],"names":["parseQueryOptions","location","query","queryString","parse","optionValues","page","limit","from","fromProductId","parseFloat","sort","keyword","categoryId","parseQueryFilters","filterValues","Object","keys","forEach","param","mr","match","filterSlug","initialState","init","categoryIsLoading","category","productsListIsLoading","productsList","options","filters","reducer","state","action","type","option","value","filter","Error","window","search","ShopProducts","props","columns","viewMode","sidebarPosition","store","forAct","doHandleChooseProduct","mainProduct","customer","doHandleFetchCompareList","offcanvas","dispatch","useReducer","content","slug","useParams","useEffect","params","x","stringify","encode","buildQuery","pathname","history","replaceState","undefined","canceled","shopApi","getProducts","token","then","result","data","item","categoryName","React","createElement","BlockLoader","productsView","ProductsView","isLoading","sorts","layout","grid","sidebarComponent","CategorySidebar","CategorySidebarItem","WidgetFilters","title","values","style","position","top","left","className","alt","src","image","width","opacity","display","height","transition","backfaceVisibility","transform","msTransform","textAlign","background","padding","color","name","priceCurrencyFormat","qty","class","sidebar","Fragment","defaultProps","connect","sidebarState","mapDispatchToProps","sidebarClose"],"mappings":"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","file":"static/js/42.8c536c45.chunk.js","sourcesContent":["// react\nimport React, { useEffect, useReducer } from \"react\";\nimport { useParams } from \"react-router-dom\";\n\n// third-party\nimport PropTypes from \"prop-types\";\nimport queryString from \"query-string\";\nimport { connect } from \"react-redux\";\n\n// application\nimport BlockLoader from \"../blocks/BlockLoader\";\nimport CategorySidebar from \"./CategorySidebar\";\nimport CategorySidebarItem from \"./CategorySidebarItem\";\nimport ProductsView from \"./ProductsView\";\nimport shopApi from \"../../api/shop\";\nimport WidgetFilters from \"../widgets/WidgetFilters\";\nimport { sidebarClose } from \"../../store/sidebar\";\n\nfunction parseQueryOptions(location) {\n    const query = queryString.parse(location);\n\n    const optionValues = {\n        page: 1,\n        limit: 6,\n        from: \"\",\n        fromProductId: \"\",\n    };\n\n    if (typeof query.page === \"string\") {\n        optionValues.page = parseFloat(query.page);\n    }\n    if (typeof query.limit === \"string\") {\n        optionValues.limit = parseFloat(query.limit);\n    }\n    if (typeof query.sort === \"string\") {\n        optionValues.sort = query.sort;\n    }\n    if (typeof query.keyword === \"string\") {\n        optionValues.keyword = query.keyword;\n    }\n    if (typeof query.from === \"string\") {\n        optionValues.from = query.from;\n    }\n    if (typeof query.fromProductId === \"string\") {\n        optionValues.fromProductId = query.fromProductId;\n    }\n    if (typeof query.categoryId === \"string\") {\n        optionValues.categoryId = query.categoryId;\n    }\n\n    return optionValues;\n}\n\nfunction parseQueryFilters(location) {\n    const query = queryString.parse(location);\n    const filterValues = {};\n\n    Object.keys(query).forEach((param) => {\n        const mr = param.match(/^filter_([-_A-Za-z0-9]+)$/);\n\n        if (!mr) {\n            return;\n        }\n\n        const filterSlug = mr[1];\n\n        filterValues[filterSlug] = query[param];\n    });\n\n    return filterValues;\n}\n\nfunction parseQuery(location) {\n    return [parseQueryOptions(location), parseQueryFilters(location)];\n}\n\nfunction buildQuery(options, filters) {\n    const params = {};\n\n    if (options.page !== 1) {\n        params.page = options.page;\n    }\n\n    if (options.limit !== 6) {\n        params.limit = options.limit;\n    }\n\n    if (options.sort !== \"\") {\n        params.sort = options.sort;\n    }\n    if (options.keyword !== \"\") {\n        params.keyword = options.keyword;\n    }\n\n    if (options.from !== \"\") {\n        params.from = options.from;\n    }\n    if (options.fromProductId !== \"\") {\n        params.fromProductId = options.fromProductId;\n    }\n\n    if (options.categoryId !== \"\") {\n        params.categoryId = options.categoryId;\n    }\n\n    Object.keys(filters)\n        .filter((x) => !!filters[x])\n        .forEach((filterSlug) => {\n            params[`filter_${filterSlug}`] = filters[filterSlug];\n        });\n\n    return queryString.stringify(params, { encode: false });\n}\n\nconst initialState = {\n    init: false,\n    /**\n     * Indicates that the category is loading.\n     */\n    categoryIsLoading: true,\n    /**\n     * Category object.\n     */\n    category: null,\n    /**\n     * Indicates that the products list is loading.\n     */\n    productsListIsLoading: true,\n    /**\n     * Products list.\n     */\n    productsList: null,\n    /**\n     * Products list options.\n     *\n     * options.page:  number - Current page.\n     * options.limit: number - Items per page.\n     * options.sort:  string - Sort algorithm.\n     */\n    options: {},\n    /**\n     * Products list filters.\n     *\n     * filters[FILTER_SLUG]: string - filter value.\n     */\n    filters: {},\n    // categoryName: \"\",\n    // categoryId: \"\",\n};\n\nfunction reducer(state, action) {\n    switch (action.type) {\n        case \"FETCH_CATEGORY_SUCCESS\":\n            return {\n                ...state,\n                init: true,\n                categoryIsLoading: false,\n                category: action.category,\n            };\n        case \"FETCH_PRODUCTS_LIST\":\n            return { ...state, productsListIsLoading: true };\n        case \"FETCH_PRODUCTS_LIST_SUCCESS\":\n            return { ...state, productsListIsLoading: false, productsList: action.productsList };\n        case \"SET_OPTION_VALUE\":\n            return {\n                ...state,\n                options: { ...state.options, page: 1, [action.option]: action.value },\n            };\n        case \"SET_FILTER_VALUE\":\n            return {\n                ...state,\n                options: { ...state.options, page: 1 },\n                filters: { ...state.filters, [action.filter]: action.value },\n            };\n        case \"RESET_FILTERS\":\n            return { ...state, options: { page: 1, limit: 6 }, filters: {} };\n        case \"RESET\":\n            return state.init ? initialState : state;\n        default:\n            throw new Error();\n    }\n}\n\nfunction init(state) {\n    const [options, filters] = parseQuery(window.location.search);\n\n    return { ...state, options, filters };\n}\n\nfunction ShopProducts(props) {\n    const {\n        columns,\n        viewMode,\n        sidebarPosition,\n        store,\n        forAct,\n        doHandleChooseProduct,\n        mainProduct,\n        customer,\n        doHandleFetchCompareList,\n    } = props;\n    const offcanvas = columns === 3 ? \"mobile\" : \"always\";\n    const [state, dispatch] = useReducer(reducer, initialState, init);\n    let { slug, categoryId } = useParams();\n\n    // Replace current url.\n    useEffect(() => {\n        const query = buildQuery(state.options, state.filters);\n\n        const location = `${window.location.pathname}${query ? \"?\" : \"\"}${query}`;\n        window.history.replaceState(null, \"\", location);\n    }, [state.options, state.filters]);\n\n    if (store !== \"\" && store !== undefined) {\n        slug = store;\n    }\n    // Load products.\n    useEffect(() => {\n        let canceled = false;\n        dispatch({ type: \"FETCH_PRODUCTS_LIST\" });\n        shopApi\n            .getProducts({ ...state.options }, { ...state.filters }, slug, categoryId, customer.token)\n            .then((result) => {\n                const { data } = result;\n                if (canceled) {\n                    return;\n                }\n\n                if (!forAct) {\n                    dispatch({\n                        type: \"FETCH_PRODUCTS_LIST_SUCCESS\",\n                        productsList: { ...data, filters: data.filters.filter((item) => item.type !== \"category\") },\n                    });\n                } else {\n                    dispatch({ type: \"FETCH_PRODUCTS_LIST_SUCCESS\", productsList: data });\n                }\n            });\n\n        return () => {\n            canceled = true;\n        };\n        //eslint-disable-next-line\n    }, [dispatch, slug, store, categoryId, state.categoryName, state.options, state.filters, customer.token]);\n\n    if (state.productsListIsLoading && !state.productsList) {\n        return <BlockLoader />;\n    }\n\n    let content;\n\n    // if (state.category) {\n    //     getCategoryParents(state.category).forEach((parent) => {\n    //         breadcrumb.push({ title: parent.name, url: url.category(parent) });\n    //     });\n\n    //     breadcrumb.push({ title: state.category.name, url: url.category(state.category) });\n\n    //     pageTitle = state.category.name;\n    // }\n\n    const productsView = (\n        <ProductsView\n            forAct={forAct}\n            doHandleChooseProduct={doHandleChooseProduct}\n            isLoading={state.productsListIsLoading}\n            productsList={state.productsList}\n            mainProduct={mainProduct}\n            sorts={state.productsList.sorts}\n            options={state.options}\n            filters={state.filters}\n            dispatch={dispatch}\n            layout={viewMode}\n            doHandleFetchCompareList={doHandleFetchCompareList}\n            grid={`grid-${columns}-${columns > 3 ? \"full\" : \"sidebar\"}`}\n            offcanvas={offcanvas}\n        />\n    );\n\n    let sidebarComponent = (\n        <CategorySidebar offcanvas={offcanvas}>\n            <CategorySidebarItem>\n                <WidgetFilters\n                    title=\"Filter\"\n                    offcanvas={offcanvas}\n                    filters={state.productsList.filters}\n                    values={state.filters}\n                    dispatch={dispatch}\n                />\n            </CategorySidebarItem>\n        </CategorySidebar>\n    );\n\n    if (forAct === \"compare\") {\n        sidebarComponent = (\n            <CategorySidebar offcanvas={offcanvas} style={{ position: \"sticky\", top: \"10px\", left: 0 }}>\n                <div className=\"card\">\n                    <div className=\"card-body\">\n                        <div className=\"row\">\n                            <div className=\"col-12\">\n                                <img\n                                    alt=\"\"\n                                    src={mainProduct.image}\n                                    style={{\n                                        width: \"100%\",\n                                        opacity: 0.7,\n                                        display: \"block\",\n                                        height: \"auto\",\n                                        transition: \".5s ease\",\n                                        backfaceVisibility: \"hidden\",\n                                    }}\n                                />\n                            </div>\n                            <div\n                                className=\"col-12 text-center\"\n                                style={{\n                                    position: \"absolute\",\n                                    top: \" 50%\",\n                                    left: \" 50%\",\n                                    transform: \"translate(-50%, -50%)\",\n                                    msTransform: \"translate(-50%, -50%)\",\n                                    textAlign: \"center\",\n                                    background: \"rgba(0,0,0,.5)\",\n                                    padding: \"17px\",\n                                    color: \"white\",\n                                }}\n                            >\n                                <h5>{mainProduct.name}</h5>\n                                <h6>{mainProduct.priceCurrencyFormat}</h6>\n                                <h6>Jumlah : {mainProduct.qty}</h6>\n                                <span class=\"badge badge-primary\">Barang Yang Dibandingkan</span>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </CategorySidebar>\n        );\n    }\n\n    if (columns > 4) {\n        content = (\n            <div className=\"container mt-5\">\n                <div className=\"block\">{productsView}</div>\n                {sidebarComponent}\n            </div>\n        );\n    } else {\n        const sidebar = <div className=\"shop-layout__sidebar\">{sidebarComponent}</div>;\n\n        content = (\n            <div style={{ background: \"rgb(236,236,237)\" }} className=\"pt-5\">\n                <div className=\"container\">\n                    <div className={`shop-layout shop-layout--sidebar--${sidebarPosition}`}>\n                        {sidebarPosition === \"start\" && sidebar}\n                        <div className=\"shop-layout__content\">\n                            <div className=\"block\">{productsView}</div>\n                        </div>\n                        {sidebarPosition === \"end\" && sidebar}\n                    </div>\n                </div>\n            </div>\n        );\n    }\n\n    return <React.Fragment>{content}</React.Fragment>;\n}\n\nShopProducts.propTypes = {\n    /**\n     * Category slug.\n     */\n    categorySlug: PropTypes.string,\n    /**\n     * number of product columns (default: 3)\n     */\n    columns: PropTypes.number,\n    /**\n     * mode of viewing the list of products (default: 'grid')\n     * one of ['grid', 'grid-with-features', 'list']\n     */\n    viewMode: PropTypes.oneOf([\"grid\", \"grid-with-features\", \"list\"]),\n    /**\n     * sidebar position (default: 'start')\n     * one of ['start', 'end']\n     * for LTR scripts \"start\" is \"left\" and \"end\" is \"right\"\n     */\n    sidebarPosition: PropTypes.oneOf([\"start\", \"end\"]),\n    forAct: PropTypes.string,\n};\n\nShopProducts.defaultProps = {\n    columns: 3,\n    viewMode: \"grid\",\n    sidebarPosition: \"start\",\n};\n\nconst mapStateToProps = (state) => ({\n    sidebarState: state.sidebar,\n    page: state.category,\n    customer: state.customer,\n});\n\nconst mapDispatchToProps = () => ({\n    sidebarClose,\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(ShopProducts);\n"],"sourceRoot":""}